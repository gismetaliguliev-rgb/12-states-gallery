# Логика Системы KIS-GALLERY (ABC-TOM)

## Главный Принцип

```
"ABC — это КТО ты. TOM — это ЧТО ты делаешь."

ABC = Фундамент (неизменная основа)
TOM = Исполнение (динамичные действия)
```

---

## Схема Потока Задачи

```
                    ┌──────────────────┐
                    │   НОВАЯ ЗАДАЧА   │
                    │   от пользователя│
                    └────────┬─────────┘
                             │
                             ▼
            ┌────────────────────────────────┐
            │     1. ЧИТАЮ C-CORE (Ядро)     │
            │   Кто мы? Для кого? Какие цели?│
            └────────────────┬───────────────┘
                             │
                             ▼
            ┌────────────────────────────────┐
            │   2. ПРОВЕРЯЮ M-MEMORY (Память)│
            │   Что уже знаем? Какие решения │
            │   принимали? Какой фидбек?     │
            └────────────────┬───────────────┘
                             │
                             ▼
            ┌────────────────────────────────┐
            │   3. ИЗУЧАЮ B-BRAIN (Мозг)     │
            │   Есть ли референсы? Исследования?│
            │   Примеры похожих решений?     │
            └────────────────┬───────────────┘
                             │
                             ▼
            ┌────────────────────────────────┐
            │  4. ВЫБИРАЮ A-AGENT (Агент)    │
            │   Какой агент нужен для задачи?│
            │   Developer? Reviewer? Content?│
            └────────────────┬───────────────┘
                             │
                             ▼
            ┌────────────────────────────────┐
            │   5. ИСПОЛЬЗУЮ T-TOOLS         │
            │   Какие инструменты/воркфлоу?  │
            │   Есть ли готовые компоненты?  │
            └────────────────┬───────────────┘
                             │
                             ▼
            ┌────────────────────────────────┐
            │   6. СОЗДАЮ O-OUTPUT (Выход)   │
            │   Результат работы → в папку   │
            │   Код, конфиги, документация   │
            └────────────────┬───────────────┘
                             │
                             ▼
            ┌────────────────────────────────┐
            │  7. ОБНОВЛЯЮ M-MEMORY (Память) │
            │   Что узнали нового?           │
            │   Какие решения приняли?       │
            └────────────────────────────────┘
```

---

## Детальные Взаимосвязи

### C-CORE → Всё остальное
**Ядро влияет на ВСЁ. Это источник правды.**

```
C-core/project-brief.md
    ↓ определяет
    ├── Какие агенты нужны (A-agents)
    ├── Какие инструменты создавать (T-tools)
    ├── Какой контент в мозге (B-brain)
    └── Критерии успеха для выхода (O-output)

C-core/tech-spec.md
    ↓ определяет
    ├── Архитектуру кода (src/)
    ├── Технические решения (M-memory/decisions)
    └── Стандарты качества (A-agents/reviewer)
```

### A-AGENTS → Выполнение задач
**Агенты — это роли, которые я "надеваю" для разных задач.**

```
A-agents/developer-agent.md
    ↓ использует
    ├── C-core/* (понять ЧТО строить)
    ├── T-tools/components/* (готовые компоненты)
    ├── M-memory/learning-log.md (прошлый опыт)
    └── B-brain/references/* (примеры)

    ↓ создаёт
    ├── src/* (код)
    └── O-output/* (результаты)

A-agents/reviewer-agent.md
    ↓ использует
    ├── C-core/tech-spec.md (стандарты)
    ├── M-memory/decisions.md (почему так)
    └── O-output/* (что проверять)

    ↓ обновляет
    └── M-memory/feedback.md (результаты ревью)

A-agents/content-agent.md
    ↓ использует
    ├── C-core/project-brief.md (стиль, голос)
    ├── T-tools/workflows/* (процессы)
    └── B-brain/references/* (примеры контента)

    ↓ создаёт
    └── public/gallery-config.json (конфиг фото)
```

### B-BRAIN → Знания и референсы
**Мозг питает агентов информацией.**

```
B-brain/
    ├── references/      → Примеры, вдохновение
    │       ↓ питает
    │       ├── A-agents (как делать)
    │       └── T-tools (что использовать)
    │
    ├── research/        → Исследования, данные
    │       ↓ питает
    │       ├── C-core (требования)
    │       └── M-memory/decisions (обоснования)
    │
    └── notes/           → Заметки, идеи
            ↓ питает
            └── Будущие задачи
```

### T-TOOLS → Инструменты выполнения
**Инструменты — это КАК мы делаем.**

```
T-tools/
    ├── components/      → Готовые куски кода
    │       ↓ используются
    │       └── A-agents/developer (при разработке)
    │
    ├── workflows/       → Пошаговые процессы
    │       ↓ используются
    │       ├── A-agents/* (все агенты)
    │       └── Пользователем (ты)
    │
    └── prompts/         → Готовые промпты (если нужны)
            ↓ используются
            └── Для типовых задач
```

### O-OUTPUT → Результаты работы
**Выход — это то, что создаётся.**

```
O-output/
    ↓ получает от
    ├── A-agents/developer → код, конфиги
    ├── A-agents/content → описания, тексты
    └── A-agents/reviewer → отчёты ревью

    ↓ отправляется в
    ├── src/ (если код)
    ├── public/ (если конфиги)
    └── Деплой (финальная версия)
```

### M-MEMORY → Память системы
**Память делает систему умнее со временем.**

```
M-memory/
    ├── learning-log.md  → ЧТО работает
    │       ↓ читается
    │       └── Перед КАЖДОЙ задачей
    │
    ├── decisions.md     → ПОЧЕМУ так решили
    │       ↓ читается
    │       ├── При похожих задачах
    │       └── При ревью
    │
    └── feedback.md      → Что говорят пользователи
            ↓ читается
            ├── При улучшениях
            └── При приоритизации
```

---

## Алгоритм Обработки Задачи

### Шаг 0: Получение задачи
```
ВХОД: Задача от пользователя
ПРИМЕР: "Добавь новую комнату в галерею"
```

### Шаг 1: Контекст из C-CORE
```python
читать("C-core/project-brief.md")
    → Понять: это соответствует целям проекта?
    → Понять: кто целевая аудитория?

читать("C-core/tech-spec.md")
    → Понять: какая архитектура?
    → Понять: какие ограничения?
```

### Шаг 2: Проверка M-MEMORY
```python
читать("M-memory/learning-log.md")
    → Делали ли похожее раньше?
    → Какие были проблемы?

читать("M-memory/decisions.md")
    → Есть ли релевантные решения?
    → Почему выбрали текущий подход?
```

### Шаг 3: Поиск в B-BRAIN
```python
искать("B-brain/references/")
    → Есть ли примеры?
    → Есть ли похожие решения?

искать("B-brain/research/")
    → Есть ли данные для решения?
```

### Шаг 4: Выбор A-AGENT
```python
если задача.тип == "разработка":
    агент = "A-agents/developer-agent.md"

если задача.тип == "контент":
    агент = "A-agents/content-agent.md"

если задача.тип == "проверка":
    агент = "A-agents/reviewer-agent.md"

читать(агент)
    → Загрузить роль и инструкции
```

### Шаг 5: Использование T-TOOLS
```python
искать("T-tools/workflows/")
    → Есть ли готовый воркфлоу?

искать("T-tools/components/")
    → Есть ли готовые компоненты?

если найдено:
    использовать(найденное)
если нет:
    создать_новое() → сохранить в T-tools/
```

### Шаг 6: Создание O-OUTPUT
```python
выполнить_задачу()
    → Создать результат

сохранить("O-output/[название-задачи]/")
    → Код, конфиги, документация

если код_готов_к_проду:
    переместить → src/ или public/
```

### Шаг 7: Обновление M-MEMORY
```python
если узнали_новое:
    добавить("M-memory/learning-log.md")

если приняли_решение:
    добавить("M-memory/decisions.md")

если получили_фидбек:
    добавить("M-memory/feedback.md")
```

---

## Примеры Потоков

### Пример 1: "Добавь фото в галерею"

```
1. C-CORE: Читаю project-brief → понимаю стиль галереи
2. M-MEMORY: Проверяю learning-log → как добавляли раньше
3. B-BRAIN: Не нужен для этой задачи
4. A-AGENT: Выбираю content-agent
5. T-TOOLS: Использую workflows/add-photo-workflow.md
6. O-OUTPUT: Обновляю gallery-config.json
7. M-MEMORY: Записываю если что-то новое узнал
```

### Пример 2: "Сделай стены темнее"

```
1. C-CORE: Читаю tech-spec → где настройки цветов
2. M-MEMORY: Проверяю decisions → почему выбрали белые стены
3. B-BRAIN: Смотрю references → примеры тёмных галерей
4. A-AGENT: Выбираю developer-agent
5. T-TOOLS: Использую components/Room.js
6. O-OUTPUT: Меняю wallColor в gallery-config.json
7. M-MEMORY: Записываю решение о смене цвета
```

### Пример 3: "Проверь производительность"

```
1. C-CORE: Читаю tech-spec → целевые показатели (60fps)
2. M-MEMORY: Читаю learning-log → прошлые оптимизации
3. B-BRAIN: Читаю research → бенчмарки Three.js
4. A-AGENT: Выбираю reviewer-agent
5. T-TOOLS: Использую чеклист из reviewer-agent.md
6. O-OUTPUT: Создаю отчёт о производительности
7. M-MEMORY: Записываю результаты в feedback.md
```

---

## Правила Системы

### Правило 1: Всегда начинай с C-CORE
> Никогда не выполняй задачу, не поняв контекст проекта.

### Правило 2: Проверяй M-MEMORY перед работой
> Не изобретай велосипед. Возможно, это уже делалось.

### Правило 3: Используй правильного агента
> Developer для кода, Content для контента, Reviewer для проверки.

### Правило 4: Документируй в T-TOOLS
> Если создал что-то переиспользуемое — сохрани как инструмент.

### Правило 5: Всегда обновляй M-MEMORY после работы
> Система учится только если записываешь уроки.

### Правило 6: O-OUTPUT — это черновик
> Сначала в O-output, потом (после проверки) в src/public.

---

## Файл-Роутер (Куда что класть)

| Тип информации | Куда класть |
|----------------|-------------|
| Требования к проекту | C-core/project-brief.md |
| Техническая архитектура | C-core/tech-spec.md |
| Примеры и вдохновение | B-brain/references/ |
| Исследования и данные | B-brain/research/ |
| Инструкции агентов | A-agents/*.md |
| Готовые компоненты | T-tools/components/ |
| Пошаговые процессы | T-tools/workflows/ |
| Результаты работы | O-output/[задача]/ |
| Готовый код | src/ |
| Конфиги и ассеты | public/ |
| Что узнали | M-memory/learning-log.md |
| Решения и почему | M-memory/decisions.md |
| Фидбек и реакции | M-memory/feedback.md |

---

## Инициализация Сессии

При каждом новом разговоре я делаю:

```
1. Читаю CLAUDE.md (точка входа)
2. Читаю C-core/* (контекст проекта)
3. Читаю M-memory/* (что помним)
4. Готов к задачам
```

---

*Эта логика делает систему самообучающейся и последовательной.*
